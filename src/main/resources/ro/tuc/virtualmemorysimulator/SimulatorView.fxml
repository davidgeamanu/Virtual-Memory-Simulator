<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.Button?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.control.TextArea?>
<?import javafx.scene.layout.AnchorPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.text.Font?>

<AnchorPane prefHeight="780.0" prefWidth="1500.0" stylesheets="@simulator-styles.css" xmlns="http://javafx.com/javafx/23.0.1" xmlns:fx="http://javafx.com/fxml/1" fx:controller="ro.tuc.virtualmemorysimulator.PresentationLayer.SimulatorController">

    <!-- ===== HEADER / TITLE ===== -->
    <Label fx:id="titleLabel" layoutX="620.0" layoutY="18.0" text="Virtual Memory Simulator">
        <font><Font name="System Bold" size="24.0" /></font>
    </Label>

    <!-- ===== LEFT PANEL: INPUT SECTION ===== -->

    <!-- Algorithm Selection -->
    <Label fx:id="algorithmLabel" layoutX="27.0" layoutY="60.0" prefHeight="26.0" prefWidth="174.0" text="Replacement Algorithm:">
        <font><Font size="14.0" /></font>
    </Label>
    <ComboBox fx:id="algorithmChoice" layoutX="209.0" layoutY="60.0" prefHeight="32.0" prefWidth="88.0" />

    <!-- Start Button -->
    <Button fx:id="startButton" layoutX="27.0" layoutY="100.0" onAction="#onStartSimulationClicked" prefHeight="32.0" prefWidth="270.0" text="Start Simulation" />

    <!-- Instruction Trace Input -->
    <Label fx:id="traceLabel" layoutX="27.0" layoutY="150.0" prefHeight="18.0" prefWidth="180.0" text="Instruction Trace (hex):">
        <font><Font name="System Bold" size="14.0" /></font>
    </Label>
    <TextArea fx:id="traceArea" layoutX="19.0" layoutY="177.0" prefHeight="142.0" prefWidth="286.0" promptText="e.g. 12345678:R, 12345ABC:W" wrapText="true" />

    <!-- Trace Control Buttons -->
    <Button fx:id="generateButton" layoutX="26.0" layoutY="326.0" onAction="#onGenerateRandomTraceClicked" prefHeight="37.0" prefWidth="150.0" text="Generate Addresses" />
    <Button fx:id="exampleButton" layoutX="27.0" layoutY="17.0" onAction="#onExampleTraceClicked" prefWidth="150" text="Load Example Trace" />
    <Button fx:id="submitButton" layoutX="183.0" layoutY="326.0" onAction="#onSubmitTraceClicked" prefHeight="35.0" prefWidth="114.0" text="Submit Trace" />

    <!-- Simulation Control Buttons -->
    <Button fx:id="stepButton" layoutX="26.0" layoutY="371.0" onAction="#onStepClicked" prefHeight="32.0" prefWidth="75.0" text="Step" />
    <Button fx:id="runButton" layoutX="111.0" layoutY="371.0" onAction="#onRunClicked" prefHeight="30.0" prefWidth="75.0" text="Run" />
    <Button fx:id="resetButton" layoutX="196.0" layoutY="371.0" onAction="#onResetClicked" prefHeight="32.0" prefWidth="100.0" text="Reset" />
    <Label fx:id="configLabel" alignment="TOP_LEFT" contentDisplay="RIGHT" layoutX="27.0" layoutY="437.0" prefHeight="218.0" prefWidth="270.0" visible="false" wrapText="true" />

    <!-- Statistics -->
    <Label fx:id="statsRequests" layoutX="23.0" layoutY="650.0" prefHeight="34.0" prefWidth="158.0" text="Requests: 0">
        <font><Font size="15.0" /></font>
    </Label>
    <Label fx:id="statsFaults" layoutX="23.0" layoutY="684.0" prefHeight="34.0" prefWidth="158.0" text="Faults: 0">
        <font><Font size="15.0" /></font>
    </Label>
    <Label fx:id="statsRate" layoutX="23.0" layoutY="718.0" prefHeight="34.0" prefWidth="158.0" text="Fault Rate: 0%" wrapText="true">
        <font><Font name="System Bold" size="15.0" /></font>
    </Label>

    <!-- ===== CENTER PANEL: INSTRUCTION & BREAKDOWN ===== -->

    <!-- Current & Next Instructions -->
    <Label fx:id="currentInstructionLabel" layoutX="330.0" layoutY="68.0" prefHeight="26.0" prefWidth="474.0" text="Current Instruction: [none]">
        <font><Font name="System Bold" size="15.0" /></font>
    </Label>
    <Label fx:id="nextInstructionsLabel" alignment="TOP_LEFT" layoutX="330.0" layoutY="97.0" prefHeight="26.0" prefWidth="474.0" text="Next Instructions: [none]" wrapText="true">
        <font><Font size="14.0" /></font>
    </Label>

    <!-- Address Breakdown -->
    <VBox fx:id="breakdownBox" alignment="CENTER" layoutX="330.0" layoutY="140.0" spacing="6.0" style="-fx-border-color: #cbd5e1; -fx-border-width: 1.5; -fx-padding: 16; -fx-background-color: white; -fx-background-radius: 12; -fx-border-radius: 12;">

        <!-- Title -->
        <Label alignment="CENTER" style="-fx-font-size: 14px; -fx-font-weight: bold;" text="Address Breakdown">
         <font>
            <Font size="14.0" />
         </font></Label>

        <!-- Column Headers -->
        <HBox spacing="0">
            <Label alignment="CENTER" prefWidth="150" style="-fx-border-color: #cbd5e1; -fx-border-width: 1; -fx-font-weight: bold; -fx-alignment: center; -fx-padding: 6; -fx-background-color: #f1f5f9;" text="Directory Index (10 bits)">
            <font>
               <Font size="11.0" />
            </font></Label>
            <Label alignment="CENTER" prefWidth="150.0" style="-fx-border-color: #cbd5e1; -fx-border-width: 1; -fx-font-weight: bold; -fx-alignment: center; -fx-padding: 6; -fx-background-color: #f1f5f9;" text="Table Index (10 bits)">
            <font>
               <Font size="11.0" />
            </font></Label>
            <Label alignment="CENTER" prefWidth="150.0" style="-fx-border-color: #cbd5e1; -fx-border-width: 1; -fx-font-weight: bold; -fx-alignment: center; -fx-padding: 6; -fx-background-color: #f1f5f9;" text="Offset (12 bits)">
            <font>
               <Font size="11.0" />
            </font></Label>
        </HBox>

        <!-- Binary Row -->
        <HBox spacing="0">
            <Label fx:id="dirBitsLabel" alignment="CENTER" prefHeight="26.0" prefWidth="150" style="-fx-border-color: #cbd5e1; -fx-border-width: 1; -fx-font-family: monospace; -fx-alignment: center; -fx-padding: 6; -fx-background-color: #f8fafc;" text="[none]" />
            <Label fx:id="tabBitsLabel" alignment="CENTER" prefHeight="26.0" prefWidth="150" style="-fx-border-color: #cbd5e1; -fx-border-width: 1; -fx-font-family: monospace; -fx-alignment: center; -fx-padding: 6; -fx-background-color: #f8fafc;" text="[none]" />
            <Label fx:id="offsetBitsLabel" alignment="CENTER" prefHeight="26.0" prefWidth="150" style="-fx-border-color: #cbd5e1; -fx-border-width: 1; -fx-font-family: monospace; -fx-alignment: center; -fx-padding: 6; -fx-background-color: #f8fafc;" text="[none]" />
        </HBox>

        <!-- Hex Row -->
        <HBox spacing="0">
            <Label fx:id="dirHexLabel" alignment="CENTER" prefHeight="26.0" prefWidth="150" style="-fx-border-color: #cbd5e1; -fx-border-width: 1; -fx-font-family: monospace; -fx-alignment: center; -fx-padding: 6; -fx-background-color: #f8fafc;" text="[none]" />
            <Label fx:id="tabHexLabel" alignment="CENTER" prefHeight="26.0" prefWidth="150" style="-fx-border-color: #cbd5e1; -fx-border-width: 1; -fx-font-family: monospace; -fx-alignment: center; -fx-padding: 6; -fx-background-color: #f8fafc;" text="[none]" />
            <Label fx:id="offsetHexLabel" alignment="CENTER" prefHeight="26.0" prefWidth="150" style="-fx-border-color: #cbd5e1; -fx-border-width: 1; -fx-font-family: monospace; -fx-alignment: center; -fx-padding: 6; -fx-background-color: #f8fafc;" text="[none]" />
        </HBox>

        <!-- VPN Label -->
        <Label fx:id="vpnLabel" alignment="CENTER" prefHeight="32.0" prefWidth="242.0" style="-fx-border-color: #3b82f6; -fx-border-width: 2; -fx-font-family: monospace; -fx-padding: 6; -fx-alignment: center; -fx-background-color: #dbeafe; -fx-background-radius: 6; -fx-border-radius: 6;" text="VPN: [none]" />
    </VBox>

    <!-- ===== RIGHT PANEL: STATUS ===== -->
    <Label fx:id="statusLabel" contentDisplay="CENTER" layoutX="832.0" layoutY="76.0" prefHeight="280.0" prefWidth="340.0" visible="false" wrapText="true">
        <font><Font size="14.0" /></font>
    </Label>

    <!-- ===== BOTTOM SECTION: TABLES ===== -->

    <!-- Page Directory -->
    <Label alignment="CENTER" layoutX="305.0" layoutY="398.0" prefHeight="20.0" prefWidth="350.0" text="Page Directory">
        <font><Font name="System Bold" size="14.0" /></font>
    </Label>
    <TableView fx:id="directoryTable" layoutX="305.0" layoutY="428.0" prefHeight="310.0" prefWidth="350.0">
        <columns>
            <TableColumn fx:id="dirIndexColumn" prefWidth="116.0" text="Dir Index" />
            <TableColumn fx:id="presentColumn" prefWidth="117.0" sortType="DESCENDING" text="Present" />
            <TableColumn fx:id="tableRefColumn" prefWidth="117.0" text="Page Table Ref" />
        </columns>
        <columnResizePolicy>
            <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
        </columnResizePolicy>
    </TableView>

    <!-- Page Table -->
    <Label fx:id="pageTableLabel" alignment="CENTER" layoutX="680.0" layoutY="398.0" prefHeight="20.0" prefWidth="486.0" text="Page Table [none]">
        <font><Font name="System Bold" size="14.0" /></font>
    </Label>
    <TableView fx:id="pageTableTable" layoutX="680.0" layoutY="428.0" prefHeight="310.0" prefWidth="486.0">
        <columns>
            <TableColumn fx:id="pageIndexColumn" prefWidth="97.0" text="Page Index" />
            <TableColumn fx:id="vpnColumnPT" prefWidth="146.0" text="VPN" />
            <TableColumn fx:id="frameColumnPT" prefWidth="97.0" text="Frame #" />
            <TableColumn fx:id="validColumn" prefWidth="73.0" sortType="DESCENDING" text="Valid" />
            <TableColumn fx:id="dirtyColumn" prefWidth="73.0" text="Dirty" />
        </columns>
    </TableView>

    <!-- Physical Memory (Frames) -->
    <Label fx:id="framesTableLabel" alignment="CENTER" layoutX="1190.0" layoutY="398.0" prefHeight="20.0" prefWidth="265.0" text="Physical Memory (Frames)">
        <font><Font name="System Bold" size="14.0" /></font>
    </Label>
    <TableView fx:id="frameTable" layoutX="1190.0" layoutY="428.0" prefHeight="310.0" prefWidth="266.0">
        <columns>
            <TableColumn fx:id="frameIdColumn" prefWidth="88.0" text="Frame #" />
            <TableColumn fx:id="vpnInFrameColumn" prefWidth="175.99997558593748" text="VPN" />
        </columns>
    </TableView>

    <!-- TLB Contents -->
    <Label fx:id="tlbLabel" alignment="CENTER" layoutX="1190.0" layoutY="48.0" prefHeight="22.0" prefWidth="265.0" text="TLB Contents">
        <font><Font name="System Bold" size="14.0" /></font>
    </Label>
    <TableView fx:id="tlbTable" layoutX="1190.0" layoutY="76.0" prefHeight="280.0" prefWidth="265.0">
        <columns>
            <TableColumn fx:id="vpnColumn" prefWidth="132.0" text="VPN" />
            <TableColumn fx:id="frameColumnTLB" prefWidth="133.0" text="Frame #" />
        </columns>
    </TableView>

</AnchorPane>
